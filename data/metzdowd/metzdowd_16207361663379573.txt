<PRE>Sorry for the long delay in responding, I was traveling out of
&quot;radio range&quot; this week.

At 06:23 PM 1/4/2008 -0500, Leichter, Jerry wrote:
&gt;|<i> &gt; | ...Also, I hate to say this, we may need to also require that all
</I>&gt;|<i> &gt; | encrypted traffic allow inspection of their contents under proper
</I>&gt;|<i> &gt; | authority (CALEA essentially)....
</I>&gt;|<i> &gt; Why not just require that the senders of malign packets set the Evil Bit
</I>&gt;|<i> &gt; in their IP headers?
</I>&gt;|<i> &gt;
</I>&gt;|<i> &gt; How can you possibly require that encrypted traffic *generated by the
</I>&gt;|<i> &gt; attackers* will allow itself to be inspected?
</I>&gt;|<i>
</I>&gt;|<i> You misunderstand me.  We can for the most part easily identify
</I>&gt;|<i> encrypted data, either it is using a standard like SSL or it is
</I>&gt;|<i> non-standard but can be identified by data payload characteristics
</I>&gt;|<i> (i.e. random bits).  If it is a standard (or even a defacto standard
</I>&gt;|<i> like Skype) we can require access under proper authority.  If it is
</I>&gt;|<i> not (or access under authority is refused), then just simply block or
</I>&gt;|<i> drop the packets, there's no need to inspect them.
</I>&gt;<i>Just because it *looks* like SSL doesn't mean that the key it leaks to
</I>&gt;<i>you is actually valid.  And if it *is* actually valid, it doesn't mean
</I>&gt;<i>that there isn't a second layer of encryption inside the SSL session.
</I>
Generally any standard encrypted protocols will probably eventually have
to support some sort of CALEA capability. For example, using a Verisign
ICA certificate to do MITM of SSL, or possibly requiring Ebay to provide
some sort of legal access to Skype private keys.  If there is a 2nd layer
of encryption then this would require initial key exchanges that may be
vulnerable to interception or after-the-fact analysis of the decrypted SSL
payloads.

&gt;<i>Go back to my example:  How will you distinguish between random bits
</I>&gt;<i>and a compressed video stream?  Do you assume that every codec in the
</I>&gt;<i>world will be registered?  How about a big scientific dataset of
</I>&gt;<i>floating point values?  Or some huge, validly formatted, spreadsheet
</I>&gt;<i>of such values?
</I>
Well, in order to be useful, codecs need to be well known.  If unknown
then they probably follow well known algorithms and thus probably be
ameniable to dogged digital forensics.

&gt;<i>And that doesn't even consider obvious countermeasures.  What happens
</I>&gt;<i>if you decrypt and see a bunch of ASCII values that follow the first
</I>&gt;<i>and second order statistics of English text?  Sure, encoding my
</I>&gt;<i>encrypted data like that costs me some overhead - but given the
</I>&gt;<i>speed of today's networks, who cares?
</I>
Sure, but then interoperability goes out the window, and I'm pretty sure
that most thieves and attackers are not going to rebuild complex protocol
stacks and textual parsers from scratch.  This is what software reuse is
all about. In the case of botnet control lines then this may be more likely
but it seems to me that once you identify the suspicious packet flows
(which you are of course looking for on the infected machine), that dedicated
forensics analysis can be done successfully.  These packets would probably
have some sort of anomolous signature compared to more normal packets
of the same nature.  Also, don't forget, at the very least L4 signature
information will never be encrypted, otherwise it would be unroutable. And
remember even if you can decrypt the botnet control lines (which still must
do key distribution/exchanges over the same comm links as the victim
computers so it should be possible to intecept them) you can certainly
block them with something like a Cisco guard.

&gt;<i>This train left the station a *long* time ago.
</I>
So it's not so clear that the train has even left the station.

- Alex


--

Alex Alten
<A HREF="http://www.metzdowd.com/mailman/listinfo/cryptography">alex at alten.org</A>



---------------------------------------------------------------------
The Cryptography Mailing List
Unsubscribe by sending &quot;unsubscribe cryptography&quot; to <A HREF="http://www.metzdowd.com/mailman/listinfo/cryptography">majordomo at metzdowd.com</A>

</PRE>